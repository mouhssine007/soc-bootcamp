# Lesson — Identifying Top HTTP Traffic Sources Using Splunk

## Objective

This lesson explains how to analyze HTTP logs in Splunk to identify the most active source IP addresses generating web traffic. This technique is commonly used by SOC analysts to detect abnormal behavior such as scanning activity, automated requests, or compromised hosts.

---

## Dataset Context

The HTTP dataset is stored in JSON format and was uploaded locally into Splunk.  
Since this lab uses file-based ingestion on a local machine, the `source` field is used instead of a custom index.

File used:

# Lesson — Identifying Top HTTP Traffic Sources Using Splunk

## Objective

This lesson explains how to analyze HTTP logs in Splunk to identify the most active source IP addresses generating web traffic. This technique is commonly used by SOC analysts to detect abnormal behavior such as scanning activity, automated requests, or compromised hosts.

---

## Dataset Context

The HTTP dataset is stored in JSON format and was uploaded locally into Splunk.  
Since this lab uses file-based ingestion on a local machine, the `source` field is used instead of a custom index.

File used:

http_lab.json


Important fields in the dataset include:

- id.orig_h — Source IP address (client)  
- id.resp_h — Destination server IP  
- uri — Requested resource  
- status_code — HTTP response code  
- user_agent — Client software information  
- resp_body_len — Response size  

---

## SPL Query Used

```spl
source="http_lab.json"
| stats count by "id.orig_h"
| sort -count
| head 10

Pipeline Breakdown

Splunk processes this query as a pipeline. Each command performs one task and passes the result to the next stage.

Data Selection Stage
source="http_lab.json"


This command tells Splunk to search only events coming from the HTTP log file named http_lab.json.

Purpose:

Restrict the search to HTTP traffic data

Avoid mixing unrelated logs

Improve analysis accuracy

Aggregation Stage
| stats count by "id.orig_h"


This command groups the events by source IP address and counts how many HTTP requests were generated by each IP.

What happens:

Each unique IP becomes one row

The count column represents how many requests were sent by that IP

Example output:

id.orig_h	count
192.168.1.20	520
10.0.0.15	340
172.16.0.8	95
Sorting Stage
| sort -count


This command sorts the results in descending order so that the most active IP addresses appear at the top.

Why this matters:

Helps quickly identify heavy traffic generators

Makes suspicious behavior easier to spot

Prioritizes investigation targets

Result Limiting Stage
| head 10


This command limits the output to the top 10 most active source IP addresses.

Purpose:

Reduce noise

Focus on the most important results

Improve dashboard and visualization clarity

SOC Analyst Use Case

This query is commonly used to:

Identify abnormal traffic volume

Detect scanning activity

Find compromised machines generating excessive requests

Monitor web abuse patterns

Investigate denial-of-service indicators

Example Interpretation

If the output shows:

185.xxx.xxx.xxx → 1200 requests


This may indicate:

Automated scanning

Scripted attacks

Bot activity

Compromised internal system

Further investigation would be required.

Important Notes

This query counts HTTP events, not unique users.

High traffic does not always mean malicious activity. Analysts must correlate with:

User-Agent values

URI access patterns

Error responses

Time-based behavior

Conclusion

Using Splunk pipelines with the stats, sort, and head commands allows analysts to quickly identify the most active HTTP clients. This forms a foundational step in web traffic monitoring and threat detection.
